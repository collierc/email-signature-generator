<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Email Signature Generator (URL-based Images)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>

  <style>
    .copy-alert {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 1rem;
      background-color: #4CAF50;
      color: white;
      border-radius: 4px;
      display: none;
      animation: fadeIn 0.3s, fadeOut 0.3s 2.7s;
    }

    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    @keyframes fadeOut {
      from {opacity: 1;}
      to {opacity: 0;}
    }

    .image-preview {
      width: 85px;
      height: 100px;
      object-fit: cover;
      border-radius: 4px;
    }
    .logo-preview {
      height: 25px;
      width: auto;
      max-width: 200px;
      object-fit: contain;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-4">
  <div id="root"></div>
  <div id="copyAlert" class="copy-alert">
    Signature copied! Paste in Gmail using Ctrl+V (or Cmd+V on Mac)
  </div>

  <script type="text/babel">

    const EmailSignatureGenerator = () => {
      const [showPreview, setShowPreview] = React.useState(false);
      const [formData, setFormData] = React.useState({
        name: '',
        title: '',
        photoUrl: '',
        companyLogoUrl: '',
        directPhone: '',
        cellPhone: '',
        email: '',
        companyWebsite: '',
        meetingLink: ''
      });

      const formatPhoneNumber = (input) => {
        const numbers = input.replace(/\D/g, '');
        if (numbers.length === 10) {
          return numbers.replace(/(\d{3})(\d{3})(\d{4})/, '$1.$2.$3');
        }
        return input;
      };

      const handleInputChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({
          ...prev,
          [name]: name === 'directPhone' || name === 'cellPhone' ? formatPhoneNumber(value) : value
        }));
      };

      const generateSignature = () => {
        const sanitizeInput = (str) => str ? str.replace(/</g, '&lt;').replace(/>/g, '&gt;') : '';
        const safeFormData = {
          name: sanitizeInput(formData.name),
          title: sanitizeInput(formData.title),
          email: sanitizeInput(formData.email),
          directPhone: sanitizeInput(formData.directPhone),
          cellPhone: sanitizeInput(formData.cellPhone),
          companyWebsite: sanitizeInput(formData.companyWebsite),
          meetingLink: sanitizeInput(formData.meetingLink)
        };
        return `<table style="font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;"><tr><td>${safeFormData.name}</td></tr></table>`;
      };

      const showCopyAlert = () => {
        const alert = document.getElementById('copyAlert');
        alert.style.display = 'block';
        setTimeout(() => alert.style.display = 'none', 3000);
      };

      const copyToClipboard = (html = false) => {
        const content = html ? generateSignature() : document.getElementById('root').innerHTML;
        navigator.clipboard.writeText(content).then(showCopyAlert);
      };

      return (
        <div className="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6">
          <h1 className="text-2xl font-bold mb-6">Email Signature Generator</h1>
          <div className="flex gap-4">
            <button onClick={() => setShowPreview(!showPreview)} className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
              {showPreview ? 'Hide Preview' : 'Show Preview'}
            </button>
            <button onClick={() => copyToClipboard(false)} className="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
              Copy Signature
            </button>
            <button onClick={() => copyToClipboard(true)} className="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">
              Copy HTML
            </button>
          </div>
        </div>
      );
    };

    ReactDOM.render(<EmailSignatureGenerator />, document.getElementById('root'));
  </script>
</body>
</html>
